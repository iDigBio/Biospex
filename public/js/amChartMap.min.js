function buildCountryMap(){am4core.useTheme(am4themes_animated);let e=am4core.create("mapDiv",am4maps.MapChart);e.hiddenState.properties.opacity=0,e.geodata=am4geodata_usaLow,e.projection=new am4maps.projections.AlbersUsa;let a=e.series.push(new am4maps.MapPolygonSeries);a.mapPolygons.template.tooltipText="{name}: {value.value.formatNumber('#')}",a.heatRules.push({property:"fill",target:a.mapPolygons.template,min:am4core.color("#a7abab"),max:am4core.color("#aa0002"),minValue:0,maxValue:Laravel.max}),a.useGeodata=!0;let t=am4core.create("mapLegendDiv",am4maps.HeatLegend);t.width=am4core.percent(100),t.series=a,t.orientation="horizontal",t.padding(20,20,20,20),t.valueAxis.renderer.labels.template.fontSize=10,t.valueAxis.renderer.minGridDistance=40,t.markerCount=6,a.mapPolygons.template.events.on("over",e=>{t.valueAxis.showTooltipAt(e.target.dataItem.value)}),a.mapPolygons.template.events.on("hit",a=>{let o=a.target.dataItem.dataContext.name,n=a.target.dataItem.dataContext.statenum,m="am4geodata_region_usa_"+o.toLowerCase()+"Low";e.dispose(),t.dispose(),$("#mapDiv").html('<div class="loader mx-auto align-self-center"></div>'),$.getScript("//www.amcharts.com/lib/4/geodata/region/usa/"+o.toLowerCase()+"Low.js").done(function(e,a){buildCountyMap(o,n,m)}).fail(function(e,a,t){$("#mapDiv").html("Error getting State map and counties.")})}),a.mapPolygons.template.strokeOpacity=.4,a.mapPolygons.template.events.on("out",function(){t.valueAxis.hideTooltip()}),e.zoomControl=new am4maps.ZoomControl,e.zoomControl.valign="top",a.data=JSON.parse(Laravel.states)}function buildCountyMap(e,a,t){let o=$.get($("#projectUrl").data("href")+"/"+a);o.done(function(e){am4core.useTheme(am4themes_animated);let a=am4core.create("mapDiv",am4maps.MapChart);a.hiddenState.properties.opacity=0,a.geodata=window[t],a.projection=new am4maps.projections.Miller,a.events.on("hit",e=>{a.dispose(),n.dispose(),buildCountryMap()});let o=a.series.push(new am4maps.MapPolygonSeries);o.mapPolygons.template.tooltipText="{name}: {value.value.formatNumber('#')}",o.heatRules.push({property:"fill",target:o.mapPolygons.template,min:am4core.color("#a7abab"),max:am4core.color("#aa0002"),minValue:0,maxValue:e.max}),o.useGeodata=!0;let n=am4core.create("mapLegendDiv",am4maps.HeatLegend);n.width=am4core.percent(100),n.series=o,n.orientation="horizontal",n.padding(20,20,20,20),n.valueAxis.renderer.labels.template.fontSize=10,n.valueAxis.renderer.minGridDistance=40,n.markerCount=6,n.maxValue=e.max,o.mapPolygons.template.events.on("over",e=>{n.valueAxis.showTooltipAt(e.target.dataItem.value)}),o.mapPolygons.template.strokeOpacity=.4,o.mapPolygons.template.events.on("out",function(){n.valueAxis.hideTooltip()}),a.zoomControl=new am4maps.ZoomControl,a.zoomControl.valign="top",o.data=JSON.parse(e.counties)}),o.fail(function(e,a,t){alert(t),stateMap.dispose(),heatLegend.dispose(),buildCountryMap()})}buildCountryMap();
