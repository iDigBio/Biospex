$(function(){let e=null,a=null;am4core.options.autoDispose=!0;let t=function(){am4core.useTheme(am4themes_animated),(e=am4core.create("mapDiv",am4maps.MapChart)).hiddenState.properties.opacity=0,e.geodata=am4geodata_usaLow,e.projection=new am4maps.projections.AlbersUsa;let o=e.series.push(new am4maps.MapPolygonSeries);o.mapPolygons.template.tooltipText="{name}: {value.value.formatNumber('#')}",o.heatRules.push({property:"fill",target:o.mapPolygons.template,min:am4core.color("#a7abab"),max:am4core.color("#aa0002"),minValue:0,maxValue:Laravel.max}),o.useGeodata=!0,(a=am4core.create("mapLegendDiv",am4maps.HeatLegend)).width=am4core.percent(100),a.series=o,a.orientation="horizontal",a.padding(20,20,20,20),a.valueAxis.renderer.labels.template.fontSize=10,a.valueAxis.renderer.minGridDistance=40,a.markerCount=6,o.mapPolygons.template.events.on("over",e=>{a.valueAxis.showTooltipAt(e.target.dataItem.value)}),o.mapPolygons.template.events.on("hit",o=>{let n=o.target.dataItem.dataContext.name,m=o.target.dataItem.dataContext.statenum,r="am4geodata_region_usa_"+n.toLowerCase()+"Low";$("#mapDiv").html('<div class="loader mx-auto align-self-center"></div>'),$.getScript("//www.amcharts.com/lib/4/geodata/region/usa/"+n.toLowerCase()+"Low.js").done(function(o,n){!function(o,n,m){let r=$.get($("#projectUrl").data("href")+"/"+n);r.done(function(o){am4core.useTheme(am4themes_animated),(e=am4core.create("mapDiv",am4maps.MapChart)).hiddenState.properties.opacity=0,e.geodata=window[m],e.projection=new am4maps.projections.Miller,e.events.on("hit",e=>{t()});let n=e.series.push(new am4maps.MapPolygonSeries);n.mapPolygons.template.tooltipText="{name}: {value.value.formatNumber('#')}",n.heatRules.push({property:"fill",target:n.mapPolygons.template,min:am4core.color("#a7abab"),max:am4core.color("#aa0002"),minValue:0,maxValue:o.max}),n.useGeodata=!0,(a=am4core.create("mapLegendDiv",am4maps.HeatLegend)).width=am4core.percent(100),a.series=n,a.orientation="horizontal",a.padding(20,20,20,20),a.valueAxis.renderer.labels.template.fontSize=10,a.valueAxis.renderer.minGridDistance=40,a.markerCount=6,a.maxValue=o.max,n.mapPolygons.template.events.on("over",e=>{a.valueAxis.showTooltipAt(e.target.dataItem.value)}),n.mapPolygons.template.strokeOpacity=.4,n.mapPolygons.template.events.on("out",function(){a.valueAxis.hideTooltip()}),e.zoomControl=new am4maps.ZoomControl,e.zoomControl.valign="top",n.data=JSON.parse(o.counties)}),r.fail(function(e,a,o){alert(o),t()})}(0,m,r)}).fail(function(e,a,t){$("#mapDiv").html("Error getting State map and counties.")})}),o.mapPolygons.template.strokeOpacity=.4,o.mapPolygons.template.events.on("out",function(){a.valueAxis.hideTooltip()}),e.zoomControl=new am4maps.ZoomControl,e.zoomControl.valign="top",o.data=JSON.parse(Laravel.states)};t()});
