let chart;am4core.ready(function(){$("#step-chart-modal").on("show.bs.modal",function(e){let t=$(e.relatedTarget).data("teams").split(","),a=$(e.relatedTarget).data("timezone"),r=$(e.relatedTarget).data("href"),n=function(){let e=new Date;return new Date(3e5*Math.ceil(e.getTime()/3e5)).getTime()-e.getTime()}();am4core.useTheme(am4themes_animated),(chart=am4core.create("chartdiv",am4charts.XYChart)).dataSource.url=r,chart.dataSource.reloadFrequency=n,chart.dataSource.incremental=!0,chart.dataSource.adapter.add("url",function(e,t){return t.lastLoad&&(chart.dataSource.reloadFrequency=3e5,e+="/"+t.lastLoad.getTime()),e}),chart.dateFormatter.inputDateFormat="yyyy-MM-dd HH:mm:ss",chart.hiddenState.properties.opacity=0,chart.padding(0,0,0,0),chart.zoomOutButton.disabled=!0,chart.events.on("datavalidated",function(){i.zoom({start:1/15,end:1.2},!1,!0)}),chart.scrollbarX=new am4core.Scrollbar;let i=chart.xAxes.push(new am4charts.DateAxis);i.baseInterval={timeUnit:"minute",count:5},i.renderer.minGridDistance=20,i.title.text=a,i.title.fontSize=20,i.dateFormats.setKey("minute","hh:mm"),i.periodChangeDateFormats.setKey("minute","[bold]h:mm a"),i.periodChangeDateFormats.setKey("hour","[bold]h:mm a"),i.renderer.axisFills.template.disabled=!0,i.renderer.ticks.template.disabled=!0,i.interpolationDuration=500,i.rangeChangeDuration=500,i.renderer.labels.template.adapter.add("rotation",function(e,t){return t.verticalCenter="middle",t.horizontalCenter="left",-90});let d=chart.yAxes.push(new am4charts.ValueAxis);d.title.text="Estimated Records Per Hour",d.title.fontSize=20,d.tooltip.disabled=!0,d.interpolationDuration=500,d.rangeChangeDuration=500,d.renderer.minLabelPosition=.05,d.renderer.maxLabelPosition=.95,d.renderer.axisFills.template.disabled=!0,d.renderer.ticks.template.disabled=!0,$.each(t,function(e,t){let a=chart.series.push(new am4charts.LineSeries);a.dataFields.dateX="date",a.dataFields.valueY=t,a.name=t,a.strokeWidth=2,a.dataItems.template.locations.dateX=0,a.interpolationDuration=500,a.defaultState.transitionDuration=0,a.tensionX=.8;let r=a.createChild(am4charts.CircleBullet);r.circle.radius=5,r.fillOpacity=1,r.fill=chart.colors.getIndex(1),r.isMeasured=!1,a.events.on("validated",function(){null!=a.dataItems.last&&(r.moveTo(a.dataItems.last.point),r.validatePosition())})}),chart.legend=new am4charts.Legend,chart.legend.labels.template.text="[bold]{name}",chart.legend.useDefaultMarker=!0;let o=chart.legend.markers.template.children.getIndex(0);o.cornerRadius(12,12,12,12),o.strokeWidth=2,o.strokeOpacity=1,o.stroke=am4core.color("#ccc")}).on("hidden.bs.modal",function(){chart.dispose()})});
