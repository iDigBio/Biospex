let weDigBioRateChart=null,interval=null;function buildChart(e,t){weDigBioRateChart=am4core.create("weDigBioRateChartDiv",am4charts.XYChart),am4core.useTheme(am4themes_animated),weDigBioRateChart.dataSource.url=e,weDigBioRateChart.dateFormatter.inputDateFormat="yyyy-MM-dd HH:mm:ss",weDigBioRateChart.hiddenState.properties.opacity=0,weDigBioRateChart.padding(0,0,0,0),weDigBioRateChart.zoomOutButton.disabled=!0;weDigBioRateChart.events.on("datavalidated",(function(e){a.zoom({start:1/15,end:1.2},!1,!0);let t=e.target,i=t.yAxes.getIndex(0),r=.3*t.data.length-i.pixelHeight,l=t.pixelHeight+r;t.svgContainer.htmlElement.style.height=l+"px"})),weDigBioRateChart.scrollbarX=new am4core.Scrollbar;let a=weDigBioRateChart.xAxes.push(new am4charts.DateAxis);a.renderer.minGridDistance=20,a.title.text="UTC Timezone",a.title.fontSize=20,a.title.align="center",a.title.fontWeight=600,a.dateFormats.setKey("minute","hh:mm"),a.periodChangeDateFormats.setKey("minute","[bold]h:mm a"),a.periodChangeDateFormats.setKey("hour","[bold]h:mm a"),a.renderer.axisFills.template.disabled=!0,a.renderer.ticks.template.disabled=!0,a.renderer.labels.template.adapter.add("rotation",(function(e,t){return t.verticalCenter="middle",t.horizontalCenter="left",-90}));let i=weDigBioRateChart.yAxes.push(new am4charts.ValueAxis);i.title.text="Estimated Records Per Hour",i.title.fontSize=20,i.tooltip.disabled=!0,i.renderer.minLabelPosition=.05,i.renderer.maxLabelPosition=.95,i.renderer.axisFills.template.disabled=!0,i.renderer.ticks.template.disabled=!0,$.each(t,(function(e,t){let a=weDigBioRateChart.series.push(new am4charts.LineSeries);a.dataFields.dateX="date",a.dataFields.valueY=t,a.name=t,a.strokeWidth=2,a.dataItems.template.locations.dateX=0,a.interpolationDuration=500,a.defaultState.transitionDuration=0,a.tensionX=.8;let i=a.createChild(am4charts.CircleBullet);i.circle.radius=5,i.fillOpacity=1,i.fill=weDigBioRateChart.colors.getIndex(1),i.isMeasured=!1,a.events.on("validated",(function(){null!=a.dataItems.last&&(i.moveTo(a.dataItems.last.point),i.validatePosition())}))})),weDigBioRateChart.legend=new am4charts.Legend,weDigBioRateChart.legend.labels.template.text="[bold]{name}",weDigBioRateChart.legend.useDefaultMarker=!0;let r=weDigBioRateChart.legend.markers.template.children.getIndex(0);r.cornerRadius(12,12,12,12),r.strokeWidth=2,r.strokeOpacity=1}am4core.ready((function(){$("#wedigbio-rate-modal").on("show.bs.modal",(function(e){let t=$(this).find("#weDigBioRateChartDiv"),a=$(e.relatedTarget).data("projects"),i=$(e.relatedTarget).data("href"),r=$(e.relatedTarget).data("date"),l=function(){am4core.disposeAllCharts(),$.get(a+"/"+r).fail((function(){t.html('<p class="d-flex justify-content-center">Failed to load projects</p>')})).done((function(e){e?buildChart(i,e):t.html('<p class="d-flex justify-content-center">No current WeDigBio Event</p>')}))};l(),setInterval(l,3e5)})).on("hidden.bs.modal",(function(){am4core.disposeAllCharts(),clearInterval(interval)}))}));
